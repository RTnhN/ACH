<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Clean Room ACH Calculator</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 20px;
    }
    label {
      display: block;
      margin-top: 10px;
    }
    input {
      margin: 5px 0;
    }
    #smallRoomInputs label {
      margin-top: 5px;
    }
  </style>
</head>
<body>
  <h1>Clean Room ACH Calculator</h1>
  
  <section>
    <h2>Large Clean Room</h2>
    <label for="volLarge">Volume (m³):</label>
    <input type="number" id="volLarge" step="any">
    
    <label for="windLarge">Windspeed (m/s):</label>
    <input type="number" id="windLarge" step="any">
    
    <label for="ffuLarge">Number of FFUs:</label>
    <input type="number" id="ffuLarge" step="1" min="1">
  </section>
  
  <section>
    <h2>Small Clean Room(s)</h2>
    <label for="volSmall">Volume (m³) per small room:</label>
    <input type="number" id="volSmall" step="any">
    
    <label for="ffuSmall">Number of FFUs (per small room):</label>
    <input type="number" id="ffuSmall" step="1" min="1">
    
    <label for="numSmallRooms">Number of Small Clean Rooms:</label>
    <input type="number" id="numSmallRooms" step="1" value="1" min="1">
    
    <!-- Dynamic windspeed inputs for each small room will appear here -->
    <div id="smallRoomInputs"></div>
  </section>
  
  <section>
    <h2>FFU Specifications</h2>
    <label for="ffuArea">FFU Area (m²):</label>
    <input type="number" id="ffuArea" step="any">
  </section>
  
  <button onclick="calculateACH()">Calculate ACH</button>
  
  <div id="results" style="margin-top:20px; font-weight: bold;"></div>
  
  <script>
    // Dynamically update windspeed boxes for small rooms based on number entered
    function updateSmallRoomInputs() {
      var numRooms = document.getElementById("numSmallRooms").value;
      var container = document.getElementById("smallRoomInputs");
      container.innerHTML = "";
      for (var i = 0; i < numRooms; i++) {
        var label = document.createElement("label");
        label.textContent = "Small Room " + (i + 1) + " Windspeed (m/s):";
        var input = document.createElement("input");
        input.type = "number";
        input.step = "any";
        input.id = "windSmall_" + i;
        container.appendChild(label);
        container.appendChild(input);
      }
    }
    
    // Update the small room inputs when the number changes and on page load
    document.getElementById("numSmallRooms").addEventListener("input", updateSmallRoomInputs);
    window.onload = updateSmallRoomInputs;
    
    function calculateACH() {
      // Get large room inputs
      var volLarge = parseFloat(document.getElementById("volLarge").value);
      var windLarge = parseFloat(document.getElementById("windLarge").value);
      var ffuLarge = parseFloat(document.getElementById("ffuLarge").value);
      var ffuArea = parseFloat(document.getElementById("ffuArea").value);
      
      if(isNaN(volLarge) || isNaN(windLarge) || isNaN(ffuLarge) || isNaN(ffuArea) || volLarge <= 0) {
        alert("Please enter valid values for the large clean room and FFU area.");
        return;
      }
      
      // Calculate large room volumetric flow (m³/hr) and ACH
      var Q_large = windLarge * ffuArea * ffuLarge * 3600;
      var ACH_large = Q_large / volLarge;
      
      // Get small room inputs
      var volSmall = parseFloat(document.getElementById("volSmall").value);
      var ffuSmall = parseFloat(document.getElementById("ffuSmall").value);
      if(isNaN(volSmall) || isNaN(ffuSmall) || volSmall <= 0) {
        alert("Please enter valid values for the small clean room and its FFUs.");
        return;
      }
      
      var numRooms = parseInt(document.getElementById("numSmallRooms").value);
      var resultsText = "<h3>Results:</h3>";
      resultsText += "<p>Large Clean Room ACH: " + ACH_large.toFixed(2) + "</p>";
      
      // For each small room, calculate its dedicated volumetric flow and effective ACH
      for(var i = 0; i < numRooms; i++){
        var windSmall = parseFloat(document.getElementById("windSmall_" + i).value);
        if(isNaN(windSmall)) {
          alert("Please enter a valid windspeed for small room " + (i + 1));
          return;
        }
        var Q_small = windSmall * ffuArea * ffuSmall * 3600;
        var ACH_small = (Q_small / volSmall) + ACH_large;
        resultsText += "<p>Small Clean Room " + (i + 1) + " ACH: " + ACH_small.toFixed(2) + "</p>";
      }
      
      document.getElementById("results").innerHTML = resultsText;
    }
  </script>
</body>
</html>
